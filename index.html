<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GearGuard Dashboard</title>
  <style>
    /* Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }

    :root {
      --bg-body: #ffffff;
      --bg-card: #f9f9f9;
      --text-primary: #333;
      --text-secondary: #444;
      --border-color: #ccc;
      --focus-color: #007bff;
      --btn-bg: #007bff;
      --btn-hover: #0069d9;
      --link-color: #007bff;
      --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      --card-border: 1px solid #eee;
    }

    .dark-mode {
      --bg-body: #121212;
      --bg-card: #1e1e1e;
      --text-primary: #fff;
      --text-secondary: #ddd;
      --border-color: #555;
      --focus-color: #61dafb;
      --btn-bg: #333;
      --btn-hover: #444;
      --link-color: #61dafb;
      --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      --card-border: 1px solid #333;
    }

    body {
      background: var(--bg-body);
      color: var(--text-primary);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
  </style>
  <link rel="stylesheet" href="css/dashboard.css">
</head>

<body class="dashboard-active">

  <!-- Theme Toggle -->
  <button class="theme-toggle" id="themeToggle">‚òÄÔ∏è</button>

  <!-- DASHBOARD VIEW -->
  <div class="dashboard-view active" id="mainDashboard">
    <div class="nav-header">
      <div style="display:flex; align-items:center; gap:20px;">
        <h2 style="margin:0;">GearGuard</h2>
      </div>
      <div class="user-profile">
        <span id="userNameDisplay" style="font-weight:600; margin-right:15px;">Welcome, User</span>
        <button onclick="handleLogout()"
          style="width:auto; padding: 8px 15px; margin:0; font-size:0.9rem; background: #666;">Logout</button>
      </div>
    </div>

    <div class="nav-tabs">
      <div class="nav-tab active">Maintenance</div>
      <div class="nav-tab" onclick="window.location.href='maintenance-calendar.html'" style="cursor: pointer;">
        Maintenance Calendar</div>
      <div class="nav-tab" onclick="window.location.href='equipment.html'" style="cursor: pointer;">Equipment</div>
      <div class="nav-tab" onclick="window.location.href='maintenance-request.html'" style="cursor: pointer;">Reporting
      </div>
      <div class="nav-tab" onclick="window.location.href='teams.html'" style="cursor: pointer;">Teams</div>
    </div>

    <!-- Stats Cards -->
    <div class="stats-container">
      <div class="stat-card critical">
        <div class="stat-title">Critical Equipment</div>
        <div class="stat-value">5 Units</div>
        <div class="stat-desc">(Health < 30%)</div>
        </div>
        <div class="stat-card load">
          <div class="stat-title">Technician Load</div>
          <div class="stat-value">85% Utilized</div>
          <div class="stat-desc">(Assign Carefully)</div>
        </div>
        <div class="stat-card open">
          <div class="stat-title">Open Requests</div>
          <div class="stat-value" id="openRequestsCount">12 Pending</div>
          <div class="stat-desc">(Keep it up!)</div>
        </div>
      </div>

      <!-- Data Table -->
      <div class="table-container">
        <div class="toolbar">
          <div class="search-bar">
            <input type="text" id="dashboardSearch" placeholder="Search requests..." />
            <button class="btn-filter" title="Filter" onclick="alert('Filter functionality - Coming soon!')">
              <i class="fas fa-filter"></i>
            </button>
          </div>
          <button class="btn-new" onclick="window.location.href='maintenance-request.html'">New</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>Subject</th>
              <th>Employee</th>
              <th>Technician</th>
              <th>Category</th>
              <th>Stage</th>
              <th>Company</th>
            </tr>
          </thead>
          <tbody id="requestTableBody">
            <!-- Populated by JS -->
          </tbody>
        </table>
      </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/dashboard.js"></script>
    <script>
      // Authentication Check
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      if (!currentUser) {
        window.location.href = 'login.html';
      } else {
        document.getElementById('userNameDisplay').textContent = "Welcome, " + currentUser.name;
      }

      // Theme Logic
      const themeToggle = document.getElementById('themeToggle');
      const body = document.body;
      const savedTheme = localStorage.getItem('theme') || 'light';

      if (savedTheme === 'dark') {
        body.classList.add('dark-mode');
        themeToggle.textContent = 'üåô';
      } else {
        themeToggle.textContent = '‚òÄÔ∏è';
      }

      themeToggle.addEventListener('click', () => {
        body.classList.toggle('dark-mode');
        const isDark = body.classList.contains('dark-mode');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        themeToggle.textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
      });

      function handleLogout() {
        localStorage.removeItem('currentUser');
        window.location.href = 'login.html';
      }
    </script>
</body>

</html>